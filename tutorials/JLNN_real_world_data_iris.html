<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html"><link rel="search" title="Search" href="../search.html"><link rel="next" title="Meta-Learning &amp; Self-Reflection" href="JLNN_xarray_meta_learning.html"><link rel="prev" title="Model Export &amp; Deployment (StableHLO, ONNX, PyTorch)" href="JLNN_model_export.html">

    <!-- Generated with Sphinx 9.1.0 and Furo 2025.12.19 -->
        <title>Real Example: Iris dataset Classification - JLNN 0.1.rc2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">JLNN 0.1.rc2 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <span class="sidebar-brand-text">JLNN 0.1.rc2 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Examples &amp; Tutorials</a><input aria-label="Toggle navigation of Examples &amp; Tutorials" checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="introduction_tutorial.html">Introductory Example: JLNN Base</a></li>
<li class="toctree-l2"><a class="reference internal" href="basic_inference_tutorial.html">Base Example: Basic inference and manual grounding</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_basic_boolean_gates.html">Basic Boolean Gates</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_weighted_rules.html">Weighted Rules &amp; Multiple Antecedents</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_temporal_logic.html">Temporal Logic (G, F, X) on Time-Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_contradiction_detection.html">Contradiction Detection &amp; Model Repair</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_model_export.html">Model Export &amp; Deployment (StableHLO, ONNX, PyTorch)</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Real Example: Iris dataset Classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_xarray_meta_learning.html">Meta-Learning &amp; Self-Reflection</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_grand_cycle_optuna.html">The Grand Cycle: Autonomous Tuning</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_graph_reasoning_pyreason.html">Differentiable Reasoning on Graphs (JLNN vs. PyReason)</a></li>
<li class="toctree-l2"><a class="reference internal" href="JLNN_explainability_rule_extraction_XAI.html">JLNN Explainability ‚Äì From scales to symbolic rules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../theory.html">Theoretical foundations of JLNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../testing.html">Testing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/core/index.html">Core Logic Engine (jlnn.core)</a><input aria-label="Toggle navigation of Core Logic Engine (jlnn.core)" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/core/activations.html">Activation Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/core/intervals.html">Interval Arithmetic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/core/logic.html">Logical Kernels</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/export/index.html">Model Export &amp; Deployment (jlnn.export)</a><input aria-label="Toggle navigation of Model Export &amp; Deployment (jlnn.export)" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/export/data.html">Metadata &amp; State Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/export/onnx.html">ONNX Export</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/export/stablehlo.html">StableHLO Integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/export/torch_map.html">PyTorch Mapping</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/nn/index.html">Neural Network Components (jlnn.nn)</a><input aria-label="Toggle navigation of Neural Network Components (jlnn.nn)" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn/base.html">Base Logical Elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn/constraints.html">Parameter Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn/functional.html">Functional Logic Kernels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn/gates.html">Logical Gates (Stateful)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/nn/predicates.html">Learned Predicates</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/reasoning/index.html">Reasoning &amp; Inference Engine (jlnn.reasoning)</a><input aria-label="Toggle navigation of Reasoning &amp; Inference Engine (jlnn.reasoning)" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/reasoning/engine.html">JAX Execution Engine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/reasoning/inspector.html">Reasoning Inspector &amp; Audit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/reasoning/temporal.html">Temporal Logic Operators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/storage/index.html">Model Storage &amp; Persistence (jlnn.storage)</a><input aria-label="Toggle navigation of Model Storage &amp; Persistence (jlnn.storage)" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/storage/checkpoints.html">Model Checkpoints</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/storage/metadata.html">Model Metadata</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/symbolic/index.html">Symbolic Front-end (jlnn.symbolic)</a><input aria-label="Toggle navigation of Symbolic Front-end (jlnn.symbolic)" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/symbolic/parser.html">Formula Parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/symbolic/compiler.html">JLNN Compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/symbolic/graph.html">Graph &amp; NetworkX Integration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/training/index.html">Training &amp; Optimization (jlnn.training)</a><input aria-label="Toggle navigation of Training &amp; Optimization (jlnn.training)" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/training/losses.html">Logical Loss Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/training/optimizers.html">Projected Optimizers</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../modules/utils/index.html">Utilities &amp; Visualization (jlnn.utils)</a><input aria-label="Toggle navigation of Utilities &amp; Visualization (jlnn.utils)" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../modules/utils/helpers.html">Helper Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/utils/metrics.html">Logical Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/utils/visualize.html">Visualization Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/utils/xarray_utils.html">Xarray Integration</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">About the Project:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to JLNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="../_sources/tutorials/JLNN_real_world_data_iris.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="real-example-iris-dataset-classification">
<h1>Real Example: Iris dataset Classification<a class="headerlink" href="#real-example-iris-dataset-classification" title="Link to this heading">¬∂</a></h1>
<p>This tutorial demonstrates the use of JLNN (JAX Logic Neural Network) to find the optimal logical description of the class <em>Iris Setosa</em>.
Unlike classical neural networks, the output is learned boundaries (‚Äúwhat is a large leaf‚Äù)
and logical weights (‚Äúwhich leaf is essential for determining the species‚Äù).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The interactive notebook is hosted externally to ensure the best viewing experience
and to allow immediate execution in the cloud.</p>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
Run in Google Colab</div>
<p class="sd-card-text">Execute the code directly in your browser without any local setup.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://colab.research.google.com/github/RadimKozl/JLNN/blob/main/examples/JLNN_real_world_data_iris.ipynb"><span>https://colab.research.google.com/github/RadimKozl/JLNN/blob/main/examples/JLNN_real_world_data_iris.ipynb</span></a></div>
</div>
<div class="sd-col sd-d-flex-row docutils">
<div class="sd-card sd-sphinx-override sd-w-100 sd-shadow-sm sd-card-hover docutils">
<div class="sd-card-body docutils">
<div class="sd-card-title sd-font-weight-bold docutils">
View on GitHub</div>
<p class="sd-card-text">View source code and outputs in the GitHub notebook browser.</p>
</div>
<a class="sd-stretched-link sd-hide-link-text reference external" href="https://github.com/RadimKozl/JLNN/blob/main/examples/JLNN_real_world_data_iris.ipynb"><span>https://github.com/RadimKozl/JLNN/blob/main/examples/JLNN_real_world_data_iris.ipynb</span></a></div>
</div>
</div>
</div>
<section id="content-overview">
<h2>Content Overview<a class="headerlink" href="#content-overview" title="Link to this heading">¬∂</a></h2>
<p>The model learns a neuro-symbolic representation of the rule: <em>‚ÄúIf the flower is small (short and narrow), then it is an Iris Setosa.‚Äù</em></p>
<ul class="simple">
<li><p><strong>Predicates:</strong> The model transforms real numbers (centimeters) into truth values ‚Äã‚Äãusing learned fuzzy boundaries.</p></li>
<li><p><strong>Logical operations:</strong> Uses weighted conjunction (Weighted AND) to aggregate attributes.</p></li>
<li><p><strong>Interpretovatelnost:</strong> V√Ωstupem nen√≠ jen klasifikace, ale i v√°hy vyjad≈ôuj√≠c√≠ d≈Øle≈æitost jednotliv√Ωch vlastnost√≠.</p></li>
</ul>
</section>
<section id="key-features-of-the-tutorial">
<h2>Key features of the tutorial<a class="headerlink" href="#key-features-of-the-tutorial" title="Link to this heading">¬∂</a></h2>
<section id="integration-with-xarray">
<h3><strong>Integration with Xarray</strong><a class="headerlink" href="#integration-with-xarray" title="Link to this heading">¬∂</a></h3>
<p>In the tutorial, we use the <code class="docutils literal notranslate"><span class="pre">model_to_xarray</span></code> function, which converts raw JAX output into a structured format with labels. This allows for easy analysis:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">model_to_xarray</span><span class="p">(</span>
    <span class="n">gate_outputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;setosa_prediction&quot;</span><span class="p">:</span> <span class="n">preds_agg</span><span class="p">},</span>
    <span class="n">sample_labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;iris_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">150</span><span class="p">)]</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="visualization-of-learned-weights">
<h3><strong>Visualization of learned weights</strong><a class="headerlink" href="#visualization-of-learned-weights" title="Link to this heading">¬∂</a></h3>
<p>The graphical representation of weights w ‚â• 1 shows how much the model ‚Äúlistens‚Äù to a given input.
A higher weight for the <code class="docutils literal notranslate"><span class="pre">~high_width</span></code> flag means that the width of the ticket
is more critical to the logical definition of Setosa than its length.</p>
</section>
<section id="uncertainty-analysis">
<h3><strong>Uncertainty analysis</strong><a class="headerlink" href="#uncertainty-analysis" title="Link to this heading">¬∂</a></h3>
<p>JLNN does not just provide a point estimate, but an interval [L, U].
The difference U - L defines the uncertainty of the model. In this tutorial, we analyze:</p>
<ul class="simple">
<li><p><strong>Average uncertainty:</strong> How confident the model is across the entire dataset.</p></li>
<li><p><strong>Uncertainty histogram:</strong> Distribution of the model‚Äôs ‚Äúdoubts‚Äù for individual samples.</p></li>
</ul>
</section>
<section id="results-and-interpretation">
<h3><strong>Results and interpretation</strong><a class="headerlink" href="#results-and-interpretation" title="Link to this heading">¬∂</a></h3>
<p>After training, the model achieves high agreement with expert botanical rules.
The resulting weight graph serves as direct evidence of what the ‚Äúblack box‚Äù neural network has learned in the language of symbolic logic.</p>
</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Link to this heading">¬∂</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">try:</span>
<span class="sd">    import jlnn</span>
<span class="sd">    from flax import nnx</span>
<span class="sd">    import jax.numpy as jnp</span>
<span class="sd">    print(&quot;‚úÖ JLNN and JAX are ready.&quot;)</span>
<span class="sd">except ImportError:</span>
<span class="sd">    print(&quot;üöÄ Installing JLNN from GitHub and fixing JAX for Colab...&quot;)</span>
<span class="sd">    # Instalace frameworku</span>
<span class="sd">    !pip install jax-lnn --quiet</span>
<span class="sd">    #!pip install git+https://github.com/RadimKozl/JLNN.git --quiet</span>
<span class="sd">    # Fix JAX/CUDA compatibility for 2026 in Colab</span>
<span class="sd">    !pip install --upgrade &quot;jax[cuda12_pip]&quot; -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html</span>

<span class="sd">    import os</span>
<span class="sd">    print(&quot;\nüîÑ RESTARTING ENVIRONMENT... Please wait a second and then run the cell again.&quot;)</span>
<span class="sd">    os.kill(os.getpid(), 9)</span>
<span class="sd">    os.kill(os.getpid(), 9) # After this line, the cell stops and the environment restarts</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flax</span><span class="w"> </span><span class="kn">import</span> <span class="n">nnx</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">optax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.datasets</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sklearn.metrics</span><span class="w"> </span><span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">confusion_matrix</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">jlnn.symbolic.compiler</span><span class="w"> </span><span class="kn">import</span> <span class="n">LNNFormula</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jlnn.nn.constraints</span><span class="w"> </span><span class="kn">import</span> <span class="n">apply_constraints</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jlnn.training.losses</span><span class="w"> </span><span class="kn">import</span> <span class="n">total_lnn_loss</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">jlnn.utils.xarray_utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">model_to_xarray</span><span class="p">,</span> <span class="n">extract_weights_to_xarray</span>

<span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>
<span class="c1"># Normalization for logical operations</span>
<span class="n">X_norm</span> <span class="o">=</span> <span class="p">(</span><span class="n">X</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-6</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">fuzzy_ramp</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">center</span><span class="p">,</span> <span class="n">steepness</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">steepness</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">center</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">))))</span>
    <span class="n">u</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">jnp</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">steepness</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="p">(</span><span class="n">center</span> <span class="o">-</span> <span class="mf">0.1</span><span class="p">))))</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">l</span><span class="p">,</span> <span class="n">u</span><span class="p">],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

<span class="n">high_length</span> <span class="o">=</span> <span class="n">fuzzy_ramp</span><span class="p">(</span><span class="n">X_norm</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">center</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">high_width</span>  <span class="o">=</span> <span class="n">fuzzy_ramp</span><span class="p">(</span><span class="n">X_norm</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">center</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">unknown_setosa</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">jnp</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">unknown_setosa</span> <span class="o">=</span> <span class="n">unknown_setosa</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span> <span class="c1"># L=0</span>
<span class="n">unknown_setosa</span> <span class="o">=</span> <span class="n">unknown_setosa</span><span class="o">.</span><span class="n">at</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span> <span class="c1"># U=1</span>

<span class="n">target_interval</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">],</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]]),</span>
    <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]])</span>
<span class="p">)</span>

<span class="n">inputs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;high_length&quot;</span><span class="p">:</span> <span class="n">high_length</span><span class="p">,</span>
    <span class="s2">&quot;high_width&quot;</span><span class="p">:</span> <span class="n">high_width</span>
<span class="p">}</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s2">&quot;0.9::(~high_length &amp; ~high_width)&quot;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LNNFormula</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Rngs</span><span class="p">(</span><span class="mi">42</span><span class="p">))</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optax</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="mf">0.02</span><span class="p">),</span> <span class="n">wrt</span><span class="o">=</span><span class="n">nnx</span><span class="o">.</span><span class="n">Param</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">float32</span><span class="p">)[:,</span> <span class="kc">None</span><span class="p">]</span>

<span class="nd">@nnx</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">train_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">loss_fn</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
        <span class="n">pred</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
        <span class="c1"># If pred returns (150, 2, 2), we reduce the gate dimension to (150, 2)</span>
        <span class="k">if</span> <span class="n">pred</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">total_lnn_loss</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>

    <span class="n">loss</span><span class="p">,</span> <span class="n">grads</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">value_and_grad</span><span class="p">(</span><span class="n">loss_fn</span><span class="p">)(</span><span class="n">model</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">grads</span><span class="p">)</span>
    <span class="n">apply_constraints</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">loss</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;üöÄ I&#39;m training a hybrid model (Expert + Data)...&quot;</span><span class="p">)</span>

<span class="c1"># Starting a workout</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">101</span><span class="p">):</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">train_step</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">target_interval</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">25</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step </span><span class="si">{</span><span class="n">step</span><span class="si">:</span><span class="s2">3d</span><span class="si">}</span><span class="s2"> | Loss: </span><span class="si">{</span><span class="n">loss</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;‚úÖ Training ended&quot;</span><span class="p">)</span>

<span class="n">preds</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

<span class="c1"># Safety print ‚Äì confirm shape</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;preds shape:&quot;</span><span class="p">,</span> <span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Reduce</span>
<span class="n">preds_reduced</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># (150, 2)</span>
<span class="c1"># preds_reduced = jnp.max(preds, axis=1)   # alternative</span>
<span class="c1"># preds_reduced = jnp.mean(preds, axis=1)</span>

<span class="c1"># Now safe to use</span>
<span class="n">acc</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">preds_reduced</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">==</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">acc</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">%)&quot;</span><span class="p">)</span>

<span class="c1"># sklearn version (if you prefer)</span>
<span class="n">acc_sk</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span>
    <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span>
    <span class="p">(</span><span class="n">preds_reduced</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;sklearn acc: </span><span class="si">{</span><span class="n">acc_sk</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Uncertainty</span>
<span class="n">widths</span> <span class="o">=</span> <span class="n">preds_reduced</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">preds_reduced</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">‚úÖ Results:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Accuracy: </span><span class="si">{</span><span class="n">acc</span><span class="si">:</span><span class="s2">.2%</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average uncertainty (U-L): </span><span class="si">{</span><span class="nb">float</span><span class="p">(</span><span class="n">widths</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Assuming your formula has one main conjunction (~high_length &amp; ~high_width)</span>
<span class="c1"># Try to extract directly ‚Äî the function is designed for this</span>

<span class="n">da_weights</span> <span class="o">=</span> <span class="n">extract_weights_to_xarray</span><span class="p">(</span>
    <span class="n">weights</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>  <span class="c1"># pass the whole model if it accepts it</span>
    <span class="n">input_labels</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;~high_length&quot;</span><span class="p">,</span> <span class="s2">&quot;~high_width&quot;</span><span class="p">],</span>   <span class="c1"># or [&quot;not_high_length&quot;, &quot;not_high_width&quot;]</span>
    <span class="n">gate_name</span><span class="o">=</span><span class="s2">&quot;conjunction&quot;</span>   <span class="c1"># try common names; may need experimentation</span>
<span class="p">)</span>

<span class="c1"># Right after preds = model(inputs)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original preds shape:&quot;</span><span class="p">,</span> <span class="n">preds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># confirms (150, 2, 2)</span>

<span class="c1"># Reduce to one [L,U] per sample</span>
<span class="n">preds_agg</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>           <span class="c1"># ‚Üí (150, 2)</span>
<span class="c1"># Alternatives you can try:</span>
<span class="c1"># preds_agg = jnp.max(preds, axis=1)         # optimistic</span>
<span class="c1"># preds_agg = jnp.mean(preds, axis=1)        # average</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Aggregated shape:&quot;</span><span class="p">,</span> <span class="n">preds_agg</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>  <span class="c1"># should be (150, 2)</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">model_to_xarray</span><span class="p">(</span>
    <span class="n">gate_outputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;setosa_prediction&quot;</span><span class="p">:</span> <span class="n">preds_agg</span><span class="p">},</span>
    <span class="n">sample_labels</span><span class="o">=</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;iris_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))]</span>
<span class="p">)</span>

<span class="n">graphdef</span><span class="p">,</span> <span class="n">state</span> <span class="o">=</span> <span class="n">nnx</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="n">state_dict</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="s1">&#39;to_dict&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">dict</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="n">weights_var</span> <span class="o">=</span> <span class="n">state_dict</span><span class="p">[</span><span class="s1">&#39;root&#39;</span><span class="p">][</span><span class="s1">&#39;gate&#39;</span><span class="p">][</span><span class="s1">&#39;weights&#39;</span><span class="p">]</span>

<span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">weights_var</span><span class="p">,</span> <span class="s1">&#39;get_value&#39;</span><span class="p">):</span>
    <span class="n">conj_weights</span> <span class="o">=</span> <span class="n">weights_var</span><span class="o">.</span><span class="n">get_value</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">conj_weights</span> <span class="o">=</span> <span class="n">weights_var</span><span class="p">[</span><span class="o">...</span><span class="p">]</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;~high_length&quot;</span><span class="p">,</span> <span class="s2">&quot;~high_width&quot;</span><span class="p">]</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">conj_weights</span><span class="o">.</span><span class="n">flatten</span><span class="p">()]</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;teal&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Trained Logic Weights (Importance of Features)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Weight Value (w &gt;= 1)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="download">
<h2>Download<a class="headerlink" href="#download" title="Link to this heading">¬∂</a></h2>
<p>You can also download the raw notebook file for local use:
<a class="reference download external" download="" href="https://github.com/RadimKozl/JLNN/blob/main/examples/JLNN_real_world_data_iris.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">JLNN_real_world_data_iris.ipynb</span></code></a></p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To run the notebook locally, make sure you have installed the package using <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">-e</span> <span class="pre">.[test]</span></code>.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="JLNN_xarray_meta_learning.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Meta-Learning &amp; Self-Reflection</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="JLNN_model_export.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Model Export &amp; Deployment (StableHLO, ONNX, PyTorch)</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2026, Ing. Radim K√∂zl
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Real Example: Iris dataset Classification</a><ul>
<li><a class="reference internal" href="#content-overview">Content Overview</a></li>
<li><a class="reference internal" href="#key-features-of-the-tutorial">Key features of the tutorial</a><ul>
<li><a class="reference internal" href="#integration-with-xarray"><strong>Integration with Xarray</strong></a></li>
<li><a class="reference internal" href="#visualization-of-learned-weights"><strong>Visualization of learned weights</strong></a></li>
<li><a class="reference internal" href="#uncertainty-analysis"><strong>Uncertainty analysis</strong></a></li>
<li><a class="reference internal" href="#results-and-interpretation"><strong>Results and interpretation</strong></a></li>
</ul>
</li>
<li><a class="reference internal" href="#example">Example</a></li>
<li><a class="reference internal" href="#download">Download</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=4d4badf9"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/scripts/furo.js?v=46bd48cc"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    </body>
</html>